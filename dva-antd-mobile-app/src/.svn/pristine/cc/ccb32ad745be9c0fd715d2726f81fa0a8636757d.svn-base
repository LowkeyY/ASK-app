<% htmlWebpackPlugin.options.headScripts = htmlWebpackPlugin.options.headScripts || [] %>
<!DOCTYPE html>
<html lang="zh">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="description" content="">
  <title>同方威视ASK项目</title>
  <!--[if lte IE 10]>
      <script
        src="https://as.alipayobjects.com/g/component/??console-polyfill/0.2.2/index.js,media-match/2.0.2/media.match.min.js"></script>
  <![endif]-->
  <% for (item of htmlWebpackPlugin.options.headScripts) { %>
    <script src="<%= item %>"></script>
  <% } %>
  <script type="text/javascript">
    window.cnClearBadge = function() {
    try {
        if (device && device.platform != "Android") {
            window.JPush.setApplicationIconBadgeNumber(0);
        } else if (cordova.plugins.notification.badge) {
            cordova.plugins.notification.badge.clear();
        }
    } catch ( exception ) {
        console.log(exception);
    }
    };

    const onDeviceReady = function() {
            alert("onDeviceReady");
            try {
                window.JPush.init();
                window.JPush.setDebugMode(true);
            } catch ( exception ) {
                console.log(exception);
            }
            window.cnClearBadge();
        },
        onResume = function() {
            alert("onResume");
            window.cnClearBadge();
        },
        onReceiveNotification = function() {
            alert("onReceiveNotification");
            if (cordova.plugins.notification.badge) {
                cordova.plugins.notification.badge.get(function(badge) {
                    (badge === 0 || +badge) && cordova.plugins.notification.badge.set(badge + 1);
                });
            }
        },
        onOpenNotification = function() {
            alert("onOpenNotification");
            window.cnClearBadge();
        };
    document.addEventListener("deviceready", onDeviceReady, false);
    document.addEventListener("resume", onResume, false);
    document.addEventListener("jpush.receiveNotification", onReceiveNotification, false);
    document.addEventListener("jpush.openNotification", onOpenNotification, false);
  </script>
</head>

<body>
  <div id="root"></div>
</body>


</html>
