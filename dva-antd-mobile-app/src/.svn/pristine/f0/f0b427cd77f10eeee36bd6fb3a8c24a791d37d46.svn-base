import React from 'react'
import { connect } from 'dva';
import { routerRedux, Icon } from 'dva/router';
import { WhiteSpace } from 'antd-mobile';
import { Nav, BaseLine } from 'components/Layout'
import MyEditor from 'components/editor/index'
import InputFoot from 'components/inputfoot/inputfoot'
import Discuss from '../discuss/index'
import DetailsComponent from '../detailscomponent/index'
import './index.less'

function Details({loading, dispatch, details}) {

    const {currentContent, id,currentComments, isShowEditor, isShowInputFoot, placeholder, is404, ...props} = details;
    const {isCollect=false} = currentContent;
    console.log(currentContent)
    console.log(isCollect)
    const contentProps = {
            ...props,
            currentContent,
            dispatch
        },
        commendProps = {
            ...props,
            currentComments,
            dispatch
    }

    const handlerCollect=()=>{
      dispatch({
        type:'details/collect',
        payload: {
          value:isCollect?0:1,
          id:id
        }
      })
    }
    return (
        <div>
          <Nav dispatch={ dispatch } {...props} isCollect={ isCollect && !is404 } handlerCollect={handlerCollect}/>
          { is404 ? (
            <div className="page-content-error">
              <img src={require('../../themes/images/404.png')} alt=""/>
              {/*<h1>页面未找到</h1>*/}
              {/*<span>(或者已删除)</span>*/}
            </div>
            ) : (
            <div>
              <DetailsComponent contentProps={ contentProps } />
              <WhiteSpace size='sm' />
              <Discuss commendProps={ commendProps } {...props} />
              <BaseLine />
              <InputFoot dispatch={ dispatch } currentComments={ currentComments } />
              <MyEditor isShowEditor={ isShowEditor } dispatch={ dispatch } placeholder={ placeholder } />
            </div>
            ) }
        </div>
    )
}
export default connect(({details, loading}) => ({
    details,
    loading,
}))(Details);
